import "tfplan"

valid_regions = ["us-west-1", "us-east-1"]

is_not_aws = func(type) {
	return type is not "aws"
}

validate_region = func(provider) {
	return all provider.alias as k, v {
		v.config.region in valid_regions
	}
}

main = rule {
	all tfplan.config.providers as k, v {
		is_not_aws(k) or validate_region(v)
	}
}
